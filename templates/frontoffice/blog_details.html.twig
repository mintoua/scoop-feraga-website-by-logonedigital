{% extends 'base_frontoffice.html.twig' %}
      {% block header %}
          {% include('includes/frontoffice/header.html.twig') %}
      {% endblock header %}
{% block content %}
    <div
            id="hero"
            class="jarallax"
            data-speed="0.7"
            data-img-position="50% 80%"
            style="background-image: url({{ asset('frontoffice/') }}img/intro_img/4.jpg)"
    >
        <div class="container">
            <div class="row">
                <div class="col-12 col-lg-7">
                    <h1 class="__title"><span>Our</span> Blog</h1>

                    <p>
                        The point of using Lorem Ipsum is that it has a more-or-less
                        normal distribution of letters, as opposed to using 'Content
                        here, content here', making it look like readable English
                    </p>
                </div>
            </div>
        </div>
    </div>
    <!-- end hero -->

    <!-- start main -->
    <main role="main">
        <!-- Common styles
        ================================================== -->
        <link rel="stylesheet" href="{{ asset('frontoffice/') }}css/style.min.css" type="text/css"/>
        <link rel="stylesheet" href="{{ asset('frontoffice/') }}css/likeStyle.css" type="text/css"/>

        <!-- Load lazyLoad scripts
        ================================================== -->
        <script src="https://code.iconify.design/2/2.2.1/iconify.min.js"></script>
        <script>
            (function (w, d) {
                var m = d.getElementsByTagName('main')[0],
                    s = d.createElement("script"),
                    v = !("IntersectionObserver" in w) ? "8.17.0" : "10.19.0",
                    o = {
                        elements_selector: ".lazy",
                        data_src: 'src',
                        data_srcset: 'srcset',
                        threshold: 500,
                        callback_enter: function (element) {

                        },
                        callback_load: function (element) {
                            element.removeAttribute('data-src')

                            oTimeout = setTimeout(function () {
                                clearTimeout(oTimeout);

                                AOS.refresh();
                            }, 1000);
                        },
                        callback_set: function (element) {

                        },
                        callback_error: function (element) {
                            element.src = "https://placeholdit.imgix.net/~text?txtsize=21&txt=Image%20not%20load&w=200&h=200";
                        }
                    };
                s.type = 'text/javascript';
                s.async = true; // This includes the script as async. See the "recipes" section for more information about async loading of LazyLoad.
                s.src = "https://cdn.jsdelivr.net/npm/vanilla-lazyload@" + v + "/dist/lazyload.min.js";
                m.appendChild(s);
                // m.insertBefore(s, m.firstChild);
                w.lazyLoadOptions = o;
            }(window, document));


            function addLike(){
                    //on recupere l URL active
                    const url = new URL(window.location.href);
                    // on lance la requette ajax
                    fetch(url.pathname + "?" + "postId=" + {{ post[0].id }}+"&ajax=1", {
                            headers: {
                                "X-Requested-With": "XMLHttpRequest"
                            }
                        }
                    ).then(response => response.json()
                    ).then(data => {
                            //        // chercher la zonne de continue
                            var content = document.getElementById("totalLike");
                            //        //remplace le continue
                            content.innerHTML = data.content;
                            //        history.pushState({},null,url.pathname + "?" + "catId="+v.toString());
                        }
                    ).catch(e => console.log(e));

            }
            document.addEventListener('DOMContentLoaded', function() {
                var likeButton = document.getElementById('like-button');
                likeButton.addEventListener('click', function() {
                    window.lb = likeButton;
                    likeButton.classList.toggle('selected');
                });
            }, false);
            window.onload = (event) => {
                var test = {{ isLiked }}
                if(test === 1) {
                    var likeButton = document.getElementById('like-button');
                    window.lb = likeButton;
                    likeButton.classList.toggle('selected');
                }
                }



        </script>

        <!-- start section -->
        {% for p in post %}
        <section class="section">
            <div class="container">
                <div class="row">
                    <div class="col-12 col-md-8 col-lg-9">
                        <div class="content-container">
                            <!-- start posts -->
                            <div class="posts">
                                <!-- start item -->
                                <div class="__item">
                                    <img width="100%"
                                         src="{{ asset('uploads/images/'~asset(p.postimage)) }}"
                                         data-src="{{ asset('uploads/images/'~asset(p.postimage)) }}" alt="demo"/>
                                    <div class="__content">

                                        <div class="mb-6 mb-md-8">
                                            <!-- <span id="like"
                                                  {#  if app.user %}
                                                  onclick="addLike()"
                                                  {% else %}
                                                    onclick="redirectToLogin()"
                                                  {% endif %}
                                            >
                                                {% if isLiked %}
                                                {% include("frontoffice/like.html.twig") %}
                                                {% else %}
                                                {% include("frontoffice/dislike.html.twig") %}
                                                {% endif #}
                                            </span> -->
                                            <br>
                                        <div class="mb-6 mb-md-8">

                                            <time class="__date-post">{{ p.getCreatedAt().format('j, M, Y ') }}</time>

                                            <p class="__category">Categorie : <a href="#">{{ p.postcategory.name }}</a></p>

                                            <h3 class="__title h3">{{ p.title }}</h3>
                                        </div>

                                        <p>
                                        </p>

                                        <p>
                                        </p>

                                        <blockquote class="blockquot">
                                            <p>
                                                <i>
                                                    {{ p.description |raw }}
                                                </i>
                                            </p>
                                        </blockquote>

                                        <p>
                                        </p>

                                        <p>
                                        </p>
                                    </div>
                                </div>
                                <!-- end item -->
                            </div>
                            <!-- end posts -->
                        </div>

                        <!-- start posts feedback -->

                        <div class="posts-feedback">
                            <button type="button" id="like-button" {% if app.user %}
                                    onclick="addLike()"
                                {% else %}
                                    onclick="location.href = '{{ path('app_sign_in') }}';"
                            {% endif %}">
                            <svg class="heart-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M91.6 13A28.7 28.7 0 0 0 51 13l-1 1-1-1A28.7 28.7 0 0 0 8.4 53.8l1 1L50 95.3l40.5-40.6 1-1a28.6 28.6 0 0 0 0-40.6z"/></svg>
                            Like
                            </button><br><br>
                            <b>4 Comments , </b>
                            <span id="totalLike" style="margin-left:7px ; margin-top: 10px"> {% include("frontoffice/totalLike.html.twig") %}</span>
                            <div id="commment_article">
                                {% include "frontoffice/CommentList.html.twig" %}

                            </div>
                            <div class="mt-6 mt-lg-10 mb-lg-4">
                                <div class="row align-items-center justify-content-between">
                                    <div class="col-12 col-md-auto mb-6">
                                        <div class="post-author">
                                            <div class="d-table">
                                                <div class="d-table-cell align-middle">
                                                    <div class="post-author__img">
                                                        <img class="img-fluid lazy" width="70"
                                                             src="{{ asset('frontoffice/') }}img/blank.gif"
                                                             data-src="{{ asset('frontoffice/') }}img/avatar.jpg"
                                                             alt="demo"/>
                                                    </div>
                                                </div>

                                                <div class="d-table-cell align-middle">
                                                    <span>Posted by</span>
                                                    <span class="post-author__name">Terens Smith</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="col-12 col-md-auto mb-6">
                                        <div class="share-btns">
                                            <ul>
                                                <li><a class="fb" href="#"><i class="fontello-facebook"></i>facebook</a>

                                                <li>
                                                    <iframe name="iframe" id="iframe"
                                                            src="https://www.facebook.com/plugins/share_button.php?href=http%3A%2F%2F127.0.0.1%3A8000%2Fblog_details%2F{{ id }}&layout=button_count&size=small&width=91&height=20&appId"
                                                            width="91" height="20" style="border:none;overflow:hidden"
                                                            scrolling="no" frameborder="0" allowfullscreen="true"
                                                            allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share"></iframe>


                                                </li>
                                                <li><a class="tw" href="#"><i class="fontello-twitter"></i>twitter</a>
                                                </li>
                                                <li><a class="ggl" href="#"><i class="fontello-gplus"></i>google
                                                        plus</a></li>
                                                <li><a class="pt" href="#"><i class="fontello-pinterest-circled"></i>pinterest</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <h6>Leave a Reply</h6>

                                {#   {{ form_start(form,{'attr': {'novalidate': 'novalidate'}} ) }} #}
                                <div class="row">
                                    <div class="col-12 col-sm-6">
                                        <div class="input-wrp">
                                            {#   {{ form_row(form.name,{'attr': {'class': 'textfield'}} ) }} #}
                                            <input id="name" class="textfield" type="text" value=""
                                                   placeholder="Name"/>
                                        </div>
                                    </div>

                                    <div class="col-12 col-sm-6">
                                        <div class="input-wrp">

                                            {#            {{ form_row(form.email,{'attr': {'class': 'textfield'}} ) }} #}

                                            <input id="email" class="textfield" type="text" value=""
                                                   placeholder="E-mail"/>
                                        </div>
                                    </div>
                                </div>

                                <div class="input-wrp">

                                    {#   {{ form_row(form.Message,{'attr': {'class': 'textfield'}} ) }} #}

                                    <textarea id="message" class="textfield" placeholder="Comments"></textarea>
                                </div>
                                {#    {{ form_widget(form.Submit,{'attr':{'class':'custom-btn custom-btn--medium custom-btn--style-1'}}) }} #}

                                <button class="custom-btn custom-btn--medium custom-btn--style-1" type="submit" onclick="addcommentjs()"
                                        role="button">post comment
                                </button>

                                {#   {{ form_end(form) }} #}
                            <script src="https://www.google.com/recaptcha/api.js?render=6Lc96AYfAAAAAAJsKTsNdyF4yBBWVnt5rWll8Dbe"></script>
                            <script>
                                grecaptcha.ready(function () {
                                    grecaptcha
                                        .execute("6Lc96AYfAAAAAAJsKTsNdyF4yBBWVnt5rWll8Dbe", {
                                            action: "homepage",
                                        })
                                        .then(function (token) {
                                            document.getElementById("blog_details_captcha").value = token;
                                        });
                                });

                                function addcommentjs() {
                                    var name = document.getElementById("name").value;
                                    var email = document.getElementById("email").value;
                                    var message = document.getElementById("message").value;
                                    //on recupere l URL active
                                    const url = new URL(window.location.href);
                                    //location.replace( "http://localhost:8000/blog_details/1?ajax=1"  );
                                   // window.location.replace(url+"?ajax=2");
                                    fetch(url.pathname + "?ajax=2 & name="+name+"& email="+email+"&message="+message, {
                                            headers: {
                                                "X-Requested-With": "XMLHttpRequest"
                                            }
                                        }
                                    ).then(response => response.json()
                                    ).then(data => {
                                            console.log(data);
                                            //        // chercher la zonne de continue
                                            var content = document.getElementById("commment_article");
                                            //        //remplace le continue
                                            content.innerHTML = data.content;
                                            //        history.pushState({},null,url.pathname + "?" + "catId="+v.toString());
                                        }
                                    ).catch(e => console.log(e));
                                    // on lance la requette ajax
                             //       fetch(url.pathname + "?" + "ajax=1",{
                             //               headers: {
                             //                   "X-Requested-With": "XMLHttpRequest",
                             //                    'Content-Type': 'application/json'
//
                             //               }
                             //           }
//
                             //       ).then(data => {
                             //           console.log(data)
                             //               // chercher la zonne de continue
                             //     //       var content = document.getElementById("commment_article");
                             //     //       //remplace le continue
                             //     //       content.innerHTML = data.content;
                             //           }
                             //       ).catch(e=>console.log(e));
                                }


                                async function postdata() {
                                    const data = new FormData();
                                    data.append('page', 'pageName');
                                    const url = new URL(window.location.href);

                                    let response = await fetch('http://localhost:8000/slim/1' + '?ajax=1', {
                                        method: 'POST',
                                        headers: {
                                            "Content-type": "application/json",
                                        },
                                        body: data
                                    })
                                    return response.json()
                                }

                            </script>
                        </div></div>
                        <!-- end posts feedback -->
                    </div>

                    <div class="col-12 my-6 d-md-none"></div>

                    <div class="col-12 col-md-4 col-lg-3">
                        <aside class="sidebar">
                            <!-- start widget -->
                            <div class="widget widget--text">
                                <h4 class="h6 widget-title">About</h4>

                                <p>
                                    We believe in helping brands create through strategy, story-telling, digital
                                    products, and integrated experiences on web, mobile, and in the world.
                                </p>
                            </div>
                            <!-- end widget -->

                            <!-- start widget -->
                            <div class="widget widget--categories">
                                <h4 class="h6 widget-title">CAtegories</h4>

                                <ul class="list">
                                    {% for c in category %}
                                        <li class="list__item">
                                            <a class="list__item__link"
                                               href="{{ path('Blog_filter',{ 'id':c.id }) }}">{{ c.name }}</a>
                                            <!-- <span>(8)</span> --!>
                                            <span>(8)</span>
                                        </li>
                                    {% endfor %}
                                </ul>
                            </div>
                            <!-- end widget -->

                            <!-- start widget -->
                            <div class="widget widget--search">
                                <form class="form--horizontal" action="#" method="get">
                                    <div class="input-wrp">
                                        <input class="textfield" name="s" type="text" placeholder="Search"/>
                                    </div>

                                    <button class="custom-btn custom-btn--tiny custom-btn--style-1" type="submit"
                                            role="button">Find
                                    </button>
                                </form>
                            </div>
                            <!-- end widget -->

                            <!-- start widget -->
                            <div class="widget widget--posts">
                                <h4 class="h6 widget-title">Features Posts</h4>

                                <div>
                                    <article>
                                        <a class="link" href="#">
                                            <img class="lazy" width="100" height="75"
                                                 src="{{ asset('frontoffice/') }}img/blank.gif"
                                                 data-src="{{ asset('frontoffice/') }}img/posts_img/1s.jpg" alt="demo"/>
                                        </a>

                                        <div>
                                            This has led us to assemble a multi

                                            <span class="date-post">April 12, 2017</span>
                                        </div>
                                    </article>

                                    <article>
                                        <a class="link" href="#">
                                            <img class="lazy" width="100" height="75"
                                                 src="{{ asset('frontoffice/') }}img/blank.gif"
                                                 data-src="{{ asset('frontoffice/') }}img/posts_img/2s.jpg" alt="demo"/>
                                        </a>

                                        <div>
                                            Our team has a passion for making things with

                                            <span class="date-post">April 12, 2017</span>
                                        </div>
                                    </article>
                                </div>
                            </div>
                            <!-- end widget -->

                            <!-- start widget -->
                            <div class="widget widget--tags">
                                <h4 class="h6 widget-title">Popular Tags</h4>

                                <ul>
                                    <li><a href="#">Art</a></li>
                                    <li><a href="#">design</a></li>
                                    <li><a href="#">concept</a></li>
                                    <li><a href="#">Media</a></li>
                                    <li><a href="#">Photography</a></li>
                                    <li><a href="#">UI</a></li>
                                </ul>
                            </div>
                            <!-- end widget -->

                            <!-- start widget -->
                            <div class="widget widget--banner">
                                <a href="#"><img class="img-fluid  lazy" src="{{ asset('frontoffice/') }}img/blank.gif"
                                                 data-src="{{ asset('frontoffice/') }}img/widget_banner.jpg"
                                                 alt="demo"/></a>
                            </div>
                            <!-- end widget -->
                        </aside>
                    </div>
                </div>
            </div>
            </div>
        </section>
        <!-- end section -->

        <!-- start section -->
        <section class="section section--no-pt">
            <div class="container">
                <ul class="post-nav">
                    <li class="post-nav__item">
                        <a class="post-nav__link post-nav__link--prev" href="#">
									<span class="d-table">
										<span class="d-table-cell align-middle"><i
                                                    class="ico fontello-left-1"></i></span>
										<span class="d-table-cell align-middle">
											Previous reading
											<span class="name">Health Benefits of a Raw Food</span>
										</span>
									</span>
                        </a>
                    </li>

                    <li class="post-nav__item">
                        <a class="post-nav__link post-nav__link--next" href="#">
									<span class="d-table">
										<span class="d-table-cell align-middle">
											next reading
											<span class="name">Tips for Ripening your Fruit</span>
										</span>
										<span class="d-table-cell align-middle"><i
                                                    class="ico fontello-right-1"></i></span>
									</span>
                        </a>
                    </li>
                </ul>
            </div>
        </section>
        <!-- end section -->
    </main>
    <!-- end main -->


    </div>

    <div id="btn-to-top-wrap">
        <a id="btn-to-top" class="circled" href="javascript:void(0);" data-visible-offset="800"></a>
    </div>

    <script src="{{ asset('frontoffice/') }}https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="{{ asset('frontoffice/') }}js/jquery-2.2.4.min.js"><\/script>')</script>

    <script type="text/javascript" src="{{ asset('frontoffice/') }}js/main.min.js"></script>
    <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
    <script>
        (function (b, o, i, l, e, r) {
            b.GoogleAnalyticsObject = l;
            b[l] || (b[l] =
                function () {
                    (b[l].q = b[l].q || []).push(arguments)
                });
            b[l].l = +new Date;
            e = o.createElement(i);
            r = o.getElementsByTagName(i)[0];
            e.src = 'https://www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e, r)
        }(window, document, 'script', 'ga'));
        ga('create', 'UA-XXXXX-X', 'auto');
        ga('send', 'pageview');
    </script>
    {% endfor %}
{% endblock content %}
      {% block footer %}
          {% include('includes/frontoffice/footer.html.twig') %}

      {% endblock footer %}

{% block javascripts %}



    <script src="{{ asset('front-office/js/fuse.js') }}"></script>

    <script src="{{ asset('front-office/js/emoji_keyboard.js') }}"></script>

    <script>(function (d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) return;
            js = d.createElement(s);
            js.id = id;
            js.src = "https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.0";
            fjs.parentNode.insertBefore(js, fjs);
            console.log(js);

        }(document, 'script', 'facebook-jssdk'));


{% endblock %}
